<!DOCTYPE HTML>
<html>
	<head>
		<title>WiT Caribbean</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/style.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">
				<!-- Main -->
					<div id="main">
						<div class="inner">
							<section class="tiles" id="app">
								
								
								
								<script>
									function parseURLParams(url) {
										var queryStart = url.indexOf("?") + 1,
											queryEnd   = url.indexOf("#") + 1 || url.length + 1,
											query = url.slice(queryStart, queryEnd - 1),
											pairs = query.replace(/\+/g, " ").split("&"),
											parms = {}, i, n, v, nv;

										if (query === url || query === "") return;

										for (i = 0; i < pairs.length; i++) {
											nv = pairs[i].split("=", 2);
											n = decodeURIComponent(nv[0]);
											v = decodeURIComponent(nv[1]);

											if (!parms.hasOwnProperty(n)) parms[n] = [];
											parms[n].push(nv.length === 2 ? v : null);
										}
										return parms;
									};

									var urlString = window.location.href;
									urlParams = parseURLParams(urlString);

									var target = urlParams['name'][0];
									// var test = document.getElementById('test').innerHTML = target;
									console.log(target);

									function fetchUserData(target) {
										var People = {};
										fetch("speakers.json")
										.then(response => response.json())
										.then(
											data => data.filter(person => { 
												if (person['name'].includes(target)){
													console.log(person)
													document.getElementById("app").innerHTML +=
														`
														<div class="content-wrapper">
															<div class="inner-row">
																<div class="col-1">
																<img src="${person["image"]}"alt="${person["name"]}"> </img>
                               													 </div>
															
															<div class="col-2 hover">
																<h3> ${person["name"]}</h3>
																<h4>Job Title: <span>${person["jobTitle"]}</span></h4>
																												<h4> from: <span>${person["homeCountry"]}</span></h4>
																<h4>Current Location: <span>${person["currentLocation"]}</span></h4>
																
															</div>
															<div class="bio hover">
																<h6><span>Bio</span></h6>
																<p>${person['bio']}</p>
															</div>
															<div class="experience hover">
																<h5>Speaking Experience: <span>${person['speakingExperience']}</span></h5>
																<h5>Description of Speaking Experience: ${person['description']}</h5>
																<h5>Appearances: 
																	<ul><p>${person['appearances'].map(apperance => {
																	return (
																		`
																			<li>
																				${apperance}
																			</li>
																		`
																	)
																}).join(' ')}</p></ul></h5>
															</div>
															<div class="links">
																${person['links'] != null ? `
																	<h5>Links: </h5>
																		<ol>
																			${person['links'].map(link => {
																				return (
																					`
																						<li>
																							<a href="${link['description']}" target= "_blank">${link['description']}"</a>
																						</li>
																					`	
																				)
																			}).join(' ')}
																		</ol>
																	`: `<span></span> `
																}
																<hr/>
																<h5>Contacts:</h5>
																<ul class="icons">
			
																	<li><a href="mailto:${person['contact']['email']}" class="icon solid style2 fa-envelope"><span class="label">Email</span></a></li>

																	${person['contact']['linkedIn'] != null ? `<li><a href="${person['contact']['linkedIn']}" target="_blank" class="icon brands style2 fa-linkedin"><span class="label">GitHub</span></a></li> ` : `<span></span>`
																	}
 
																	${person['contact']['instagram'] != null ? `<li><a href="${person['contact']['instagram']}" target="_blank" class="icon brands style2 fa-instagram"><span class="label">Instagram</span></a></li> ` : `<span></span>`
																	}

																	${person['contact']['twitter'] != null ? `<li><a href="${person['contact']['twitter']}" target="_blank" class="icon brands style2 fa-twitter"><span class="label">Twitter</span></a></li> ` : `<span></span>`
																	}
																	
																</ul>
															</div>
														</div>
														`
												}
											}
										))
										.catch(
											error => {
												console.log(error);
												window.location.replace("/");
											}
										)
									};

									

									var miss = fetchUserData(target);
									console.log(miss);

								</script>
							</section>
						</div>
					</div>
			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
